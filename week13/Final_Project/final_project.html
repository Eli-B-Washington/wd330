<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Baseball Statistics SPA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="css/style.css">


<script>




</script>
</head>

<body>
    <main>
        <h1>Baseball Statistics App</h1>
        <h2>
        This App will return baseball statistics for the top 10
        pitchers and hitters of a given year.
        </h2>

        <form action="">
            <label for="year">Select A Year: </label>
            <select id="year"></select>

            <button name="button" id="button" value="submit">Click Me!</button>   
        </form>

        <div class="result" id="result1"></div>
        <div class="result" id="result2"></div>
        <div class="result" id="result3"></div>
        <div class="result" id="result4"></div>
        <div class="result" id="result5"></div>
        <div class="result" id="result6"></div>
        <div class="result" id="result7"></div>
        <div class="result" id="result8"></div>
        <div class="result" id="result9"></div>
        <div class="result" id="result10"></div>


    </main>



    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>

        var start = 1869;
        var end = new Date().getFullYear();
        var options = "";
        for (var year = start; year <= end; year++) {
            options += "<option>" + year + "</option>";
        }
        document.getElementById("year").innerHTML = options;


var object = document.getElementById("button").addEventListener("click", goFunction);

var obj, dbParam, xmlhttp, myObj, x, txt = "";



async function goFunction(){

queryString = "?results='3'&sports_code='mlb'&sort_column='era'&season='1908'&game_type='R'&leader_hitting_repeater.col_in=era"
var url = "https://mlb-data.p.rapidapi.com/json/named.leader_pitching_repeater.bam"

fetch(url + queryString, {
	"method": "GET",
	"headers": {
		"x-rapidapi-key": "c1eed3bc67msh45ea31acdbf685dp1b3b6bjsn638c0b567e02",
		"x-rapidapi-host": "mlb-data.p.rapidapi.com"
	}
})

.then(response => response.json())
.then(data => {
  console.log('Success:', data);

  var myObj = (data.leader_pitching_repeater.leader_pitching_mux.queryResults.row);

  txt += "<table border='1'>"
  for (x in myObj) {
        txt += "<th>" + "Name" + "</th>";
        txt += "<th>" + "E.R.A." + "</th>";

      txt += "<tr><td>" + myObj[x].name_display_first_last + "</td>";
      txt += "<td>" + myObj[x].era + "</td></tr>";
      
    }
    txt += "</table>"    
    document.getElementById("result1").innerHTML = txt;

  //document.getElementById("result1").innerHTML = JSON.stringify(data);
  document.getElementById("result2").innerHTML =
  JSON.stringify(data.leader_pitching_repeater.leader_pitching_mux.queryResults.row);
})

.catch(err => {
	console.error(err);
});
}


goFunction();




/*function loadDoc(url, cFunction) {
          var xhttp;
          xhttp=new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              cFunction(this);
            }
          };
          xhttp.open("GET", url, true);
          xhttp.send();
        }

        function myFunction1(xhttp) {
          var obj = JSON.parse(xhttp.responseText);
          var completed = JSON.stringify(obj);
          console.log(obj);
          document.getElementById("result1").innerHTML =
          obj[0].gameplay;
        }
*/
    </script>
    <!--<script src="js/index.js" type="module"></script> -->
</body>

</html>